---
title: 前端性能优化之图片
date: 2017-10-27 10:11:26
tags:
---


##	图片优化的必要性
在我们前端优化的种种方案中,包括js、html、css文件的打包压缩合并到极致,我们节省的空间至多也就是几十K的大小,但是在图片领域能够优化的空间,往往能够达到几百k到几M的范畴,这对于一个页面而言,优化力度可是极大的.所以在前端优化中,图片的优化是至关重要的.

##	图片格式认知
目前在项目开发中常见的图片格式,包括有:
- jpg
- png
- gif
- svg
- WebP

###	jpg格式
`jpg` 全称叫做`jpeg`,`.jpg`和`.jpeg`这两种扩展名的实质是相同的，但因为DOS时代的8.3文件名命名原则是:拓展名不能超过三位,所以直接用作`.jpg`,虽然现在windows也可以支持任意长度的扩展名了，但大家已经习惯了.jpg的叫法，因此也就没有强制修正.

#### baseline-jpeg 
#### preogressive-jpeg

![](http://7tszky.com1.z0.glb.clouddn.com/Fo8q3huYFyQma_rsSvo28dUyd7mN)
jpeg优势： 非常通用，图片更小
jpeg劣势： 图片色彩不够丰富,且不支持透明.

###	PNG格式
`PNG`,可移植网络图形格式,这种类型的图片可以展示 256 种颜色，而且每一种颜色都可以做成透明,所以这类图片我们常用来做透明和半透明的素材,缺点则是体积较大.

###	GIF格式
`GIF`,一般都理解为gif动画,其实`GIF`也可以存储图片,同时也支持透明,但作为图片,`GIF`只支持透明和不透明,不支持半透明,而且相对于`png`的图片,`GIF`的占用空间更大,它的唯一优势在于它是支持动画,而其他格式都不支持,所以一般我们图片是不使用`GIF`格式,只有在用动画的情况才使用。

###	svg格式
可缩放矢量图形，属于 XML 格式，百度地图就是使用 svg 绘制的，位图当你放大时单位面积内可视的像素点会变少，所以会失真，也就是我们常说的图片模糊，首先 svg 它是一个可以进行计算矢量图，放大和缩小的时每一个像素会根据向量重新计算，不会失真，并且 svg 的体积很小。

###	WebP
是 Google 于2010年提出了一种新的图片压缩格式，`WebP` 为网络图片提供了无损和有损压缩能力，同时在有损条件下支持透明通道；无损 `WebP` 相比 `PNG` 减少26%大小，有损 `WebP` 在相同的结构相似性下相比 `JPEG` 减少 25%~34% 的大小，所以它也同时具备 `jpg` 和 `png` 的优点。
简单来说就是,体积比`jpeg`更小,而且还支持透明和半透明,渲染速度更快。
但在兼容性上只支持Chrome(29+)、Opera、和Android Brower,firefox和safari都不支持.
![](http://static.zybuluo.com/jasminecjc/z1ik03y2es81x990qq35hutz/1.png)

###	图片使用
说着这么多的图片类型，我们在项目开发中，如何基于性能和用户体验的权衡来选择合适的图片类型呢？

如果是颜色丰富的图片，jpg 是通用的选择。
如果是较通用的动画，gif 是唯一可用的选择。
如果需要清晰的显示颜色丰富和透明的图片，png 是比较好的选择。
如果是企业级应用（不考虑兼容性），可以选择 WebP。


###	目前比较流行的做法

#### 压缩图片
智图: [http://zhitu.tencent.com/ ](http://zhitu.tencent.com/  "智图")
Kraken: [https://kraken.io/](https://kraken.io/ "Kraken ")
####  CSS Sprites(雪碧图)
**场景**：任何用到页面图片的场景 
**原理**：将多个页面上用到的背景图片合并成一个大的图片在页面中引用 
**优势**：可以有效的较少请求个数，而且，而不影响开发体验，使用构建插件可以做到对开发者透明。适用于页面图片多且丰富的场景。 
**劣势**：生成的图片体积较大，减少请求个数同时也增加了图片大小，不合理拆分将不利于并行加载。

#### 使用base64编码代替图片
适用于图片大小小于2KB，页面上引用图片总数不多的情况,可以减少http请求。

####  iconfont、CSS3代替图片
css方式可以用来绘制相对简单的图来代替图片，一般使用before或者after伪元素来丰富图案的复杂度。
iconfont可以代替传统图片的icon.
这两种方式都是为了减少网页中图片的使用。

####  响应式动态图片加载
**场景**：不同终端对同一个图片需求不一样，可以根据终端加载不同的图片来节省没必要的流量 
**原理**：通过picture元素，picturefill或平台判断来为不同终端平台输出不同的图片 
**优势**：减少没必要的图片加载，灵活控制，慢速用户加载小图片不至于加载失败，移动端没必要加载大尺寸图片等，可以通过不同方式兼容所有浏览器 
**劣势**：无法避免图片的加载过程，图片本身没优化